(this.webpackJsonpreactblog=this.webpackJsonpreactblog||[]).push([[12],{199:function(e,t,n){"use strict";var a=n(13),r=n.n(a),c=n(200),o=n(20),i=n(7),s=n(0),u=n(750),l=n(775),d=n(747),f=n(177),p=n(521),b=n(43),j=n(93),h=n(203),m=n.n(h),O=n(197),v=n(193),x=n.n(v),g=n(10);t.a=function(e){var t=e.type,n=e.refresh,a=e.other_id,h=void 0===a?"":a,v=e.width,_=void 0===v?"170px":v,w=Object(s.useContext)(j.a).username,y=Object(s.useState)(),k=Object(i.a)(y,2),L=k[0],F=k[1],N=Object(s.useState)(),C=Object(i.a)(N,2),M=C[0],I=C[1],E=Object(s.useState)(),H=Object(i.a)(E,2),S=H[0],V=H[1],z=function(){var e=Object(o.a)(r.a.mark((function e(){var t,n,a,o,i,s,l,d,f,p;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,navigator.clipboard.read();case 2:t=e.sent,n=!1,a=Object(c.a)(t),e.prev=5,a.s();case 7:if((o=a.n()).done){e.next=34;break}i=o.value,s=Object(c.a)(i.types),e.prev=10,s.s();case 12:if((l=s.n()).done){e.next=24;break}if(d=l.value,n||-1===d.indexOf("image")){e.next=22;break}return console.log("clipboardItem",i),n=!0,e.next=19,i.getType(d);case 19:f=e.sent,p=new File([f],x()().format("YYYY-MM-DD HH:mm:ss")+"."+d.split("/").pop(),{type:f.type}),P(p);case 22:e.next=12;break;case 24:e.next=29;break;case 26:e.prev=26,e.t0=e.catch(10),s.e(e.t0);case 29:return e.prev=29,s.f(),e.finish(29);case 32:e.next=7;break;case 34:e.next=39;break;case 36:e.prev=36,e.t1=e.catch(5),a.e(e.t1);case 39:return e.prev=39,a.f(),e.finish(39);case 42:n||u.a.warning("\u8bf7\u5148\u622a\u56fe\uff0c\u518d\u7c98\u8d34");case 43:case"end":return e.stop()}}),e,null,[[5,36,39,42],[10,26,29,32]])})));return function(){return e.apply(this,arguments)}}(),D=function(){var e=Object(o.a)(r.a.mark((function e(){var t,n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===(t=prompt("\u8bf7\u8f93\u5165\u5c06\u4e0a\u4f20\u7684\u56fe\u7247\u7684 url"))||""===t){e.next=6;break}return e.next=4,fetch(t).then((function(e){return e.blob()})).then((function(e){return e.type.includes("images")?new File([e],x()().format("YYYY-MM-DD HH:mm:ss")+"."+e.type.split("/").pop(),{type:e.type}):(u.a.error("\u8bf7\u8f93\u5165\u56fe\u7247\u7684 url\uff0c\u5f53\u524d url \u6293\u4e0d\u5230\u56fe\u7247"),!1)}));case 4:(n=e.sent)&&P(n);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),T=Object(s.useState)(!1),B=Object(i.a)(T,2),R=B[0],A=B[1],P=function(e){A(!0);var a=new FormData;a.append("other_id",h),a.append("username",w),a.append(t,e),fetch("".concat(b.d,"/api/").concat(t,"_upload"),{method:"POST",body:a}).then((function(e){return e.json()})).then((function(e){u.a.success(e.message),n()})).catch((function(e){console.log(e)})).finally((function(){A(!1)}))};return Object(g.jsx)("div",{className:m.a.uploadWrapper,style:{width:"".concat(_),height:"".concat(_)},children:Object(g.jsx)(l.a,{className:m.a.upload,style:{width:"".concat(_),height:"".concat(_)},name:t,showUploadList:!1,action:"".concat(b.d,"/api/").concat(t,"_upload"),data:{other_id:h,username:w},beforeUpload:function(e){return F(e.name),I(0),V(e.size),!0},listType:"picture-card",onChange:function(e){"uploading"===e.file.status&&I(e.file.percent),"done"===e.file.status&&(u.a.success("\u4e0a\u4f20\u56fe\u7247\u6210\u529f"),F(void 0),n()),"error"===e.file.status&&u.a.error("\u4e0a\u4f20\u56fe\u7247\u5931\u8d25")},children:L?Object(g.jsxs)("div",{className:m.a.progress,children:[Object(g.jsx)("div",{className:m.a.name,children:L}),Object(g.jsx)("div",{children:Object(O.b)(S||0)}),Object(g.jsxs)("div",{children:["\u8fdb\u5ea6\uff1a",(M||0).toFixed(1),"%"]}),Object(g.jsx)(d.a,{strokeColor:{from:"#108ee9",to:"#87d068"},percent:M,status:"active"})]}):Object(g.jsxs)("div",{className:m.a.beforeUpload,children:[Object(g.jsx)(p.a,{className:m.a.addIcon}),"\u70b9\u51fb\u4e0a\u4f20\u56fe\u7247/\u6587\u4ef6",Object(g.jsx)(f.a,{className:m.a.parseButton,onClick:function(e){z(),e.preventDefault(),e.stopPropagation()},loading:R,children:"\u7c98\u8d34\u56fe\u7247"}),Object(g.jsx)(f.a,{onClick:function(e){D(),e.preventDefault(),e.stopPropagation()},loading:R,children:"\u7c98\u8d34\u94fe\u63a5"})]})})})}},203:function(e,t,n){e.exports={uploadWrapper:"file-image-upload_uploadWrapper__2KNmk",upload:"file-image-upload_upload__1_D8X",addIcon:"file-image-upload_addIcon__1icNG",progress:"file-image-upload_progress__1bAIy",name:"file-image-upload_name__2Am_K"}},276:function(e,t,n){"use strict";var a=n(1);t.a=function(e){var t;return Object(a.a)({},e.componentCls,(t={},Object(a.a)(t,"".concat(e.antCls,"-motion-collapse-legacy"),{overflow:"hidden","&-active":{transition:"height ".concat(e.motionDurationMid," ").concat(e.motionEaseInOut,",\n        opacity ").concat(e.motionDurationMid," ").concat(e.motionEaseInOut," !important")}}),Object(a.a)(t,"".concat(e.antCls,"-motion-collapse"),{overflow:"hidden",transition:"height ".concat(e.motionDurationMid," ").concat(e.motionEaseInOut,",\n        opacity ").concat(e.motionDurationMid," ").concat(e.motionEaseInOut," !important")}),t))}},328:function(e,t,n){"use strict";var a=n(2),r=n(0),c={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M257.7 752c2 0 4-.2 6-.5L431.9 722c2-.4 3.9-1.3 5.3-2.8l423.9-423.9a9.96 9.96 0 000-14.1L694.9 114.9c-1.9-1.9-4.4-2.9-7.1-2.9s-5.2 1-7.1 2.9L256.8 538.8c-1.5 1.5-2.4 3.3-2.8 5.3l-29.5 168.2a33.5 33.5 0 009.4 29.8c6.6 6.4 14.9 9.9 23.8 9.9zm67.4-174.4L687.8 215l73.3 73.3-362.7 362.6-88.9 15.7 15.6-89zM880 836H144c-17.7 0-32 14.3-32 32v36c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-36c0-17.7-14.3-32-32-32z"}}]},name:"edit",theme:"outlined"},o=n(186),i=function(e,t){return r.createElement(o.a,Object(a.a)(Object(a.a)({},e),{},{ref:t,icon:c}))};i.displayName="EditOutlined";t.a=r.forwardRef(i)},495:function(e,t,n){"use strict";var a=n(2),r=n(0),c={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M868 545.5L536.1 163a31.96 31.96 0 00-48.3 0L156 545.5a7.97 7.97 0 006 13.2h81c4.6 0 9-2 12.1-5.5L474 300.9V864c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V300.9l218.9 252.3c3 3.5 7.4 5.5 12.1 5.5h81c6.8 0 10.5-8 6-13.2z"}}]},name:"arrow-up",theme:"outlined"},o=n(186),i=function(e,t){return r.createElement(o.a,Object(a.a)(Object(a.a)({},e),{},{ref:t,icon:c}))};i.displayName="ArrowUpOutlined";t.a=r.forwardRef(i)},496:function(e,t,n){"use strict";var a=n(2),r=n(0),c={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M864 736c0-111.6-65.4-208-160-252.9V317.3c0-15.1-5.3-29.7-15.1-41.2L536.5 95.4C530.1 87.8 521 84 512 84s-18.1 3.8-24.5 11.4L335.1 276.1a63.97 63.97 0 00-15.1 41.2v165.8C225.4 528 160 624.4 160 736h156.5c-2.3 7.2-3.5 15-3.5 23.8 0 22.1 7.6 43.7 21.4 60.8a97.2 97.2 0 0043.1 30.6c23.1 54 75.6 88.8 134.5 88.8 29.1 0 57.3-8.6 81.4-24.8 23.6-15.8 41.9-37.9 53-64a97 97 0 0043.1-30.5 97.52 97.52 0 0021.4-60.8c0-8.4-1.1-16.4-3.1-23.8H864zM762.3 621.4c9.4 14.6 17 30.3 22.5 46.6H700V558.7a211.6 211.6 0 0162.3 62.7zM388 483.1V318.8l124-147 124 147V668H388V483.1zM239.2 668c5.5-16.3 13.1-32 22.5-46.6 16.3-25.2 37.5-46.5 62.3-62.7V668h-84.8zm388.9 116.2c-5.2 3-11.2 4.2-17.1 3.4l-19.5-2.4-2.8 19.4c-5.4 37.9-38.4 66.5-76.7 66.5-38.3 0-71.3-28.6-76.7-66.5l-2.8-19.5-19.5 2.5a27.7 27.7 0 01-17.1-3.5c-8.7-5-14.1-14.3-14.1-24.4 0-10.6 5.9-19.4 14.6-23.8h231.3c8.8 4.5 14.6 13.3 14.6 23.8-.1 10.2-5.5 19.6-14.2 24.5zM464 400a48 48 0 1096 0 48 48 0 10-96 0z"}}]},name:"rocket",theme:"outlined"},o=n(186),i=function(e,t){return r.createElement(o.a,Object(a.a)(Object(a.a)({},e),{},{ref:t,icon:c}))};i.displayName="RocketOutlined";t.a=r.forwardRef(i)},640:function(e,t,n){e.exports={cloud:"cloud_cloud__3vbVo",cloudContent:"cloud_cloudContent__3OX5i"}},641:function(e,t,n){e.exports={cloudTree:"cloud-storage_cloudTree__3Pf6b",addFolder:"cloud-storage_addFolder__JL0yp",goback:"cloud-storage_goback__3TVFE"}},642:function(e,t,n){e.exports={cloudStorage:"folder-content_cloudStorage__snpcg",folderBox:"folder-content_folderBox__2IvK4",folderIcon:"folder-content_folderIcon__lUamr",icon:"folder-content_icon__3lmL7",imgLength:"folder-content_imgLength__1Iqry"}},643:function(e,t,n){e.exports={folderBox:"folder-list_folderBox__1IgNJ",folderIcon:"folder-list_folderIcon__32PNC",icon:"folder-list_icon__vCEFg",imgLength:"folder-list_imgLength__3VaBr"}},644:function(e,t,n){"use strict";var a=n(2),r=n(0),c=n(340),o=n(186),i=function(e,t){return r.createElement(o.a,Object(a.a)(Object(a.a)({},e),{},{ref:t,icon:c.a}))};i.displayName="DownOutlined",t.a=r.forwardRef(i)},776:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n(640),c=n.n(r),o=n(191),i=n(13),s=n.n(i),u=n(20),l=n(7),d=n(641),f=n.n(d),p=n(93),b=n(32);function j(e,t){return h.apply(this,arguments)}function h(){return(h=Object(u.a)(s.a.mark((function e(t,n){var a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(b.a)("/folder/getFolder?parentId=".concat(t,"&username=").concat(n));case 2:return a=e.sent,e.abrupt("return",a&&"success"===a.resultsCode?a.data:[]);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function m(e){return O.apply(this,arguments)}function O(){return(O=Object(u.a)(s.a.mark((function e(t){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(b.a)("/folder/getAllFolder?username=".concat(t));case 2:return n=e.sent,e.abrupt("return",!(!n||"success"!==n.resultsCode)&&n.data);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function v(e){return x.apply(this,arguments)}function x(){return(x=Object(u.a)(s.a.mark((function e(t){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(b.c)("/folder/addFolder",t);case 2:return n=e.sent,e.abrupt("return",!(!n||"success"!==n.resultsCode)&&n);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function g(e){return _.apply(this,arguments)}function _(){return(_=Object(u.a)(s.a.mark((function e(t){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(b.c)("/folder/updateFolderName",t);case 2:return n=e.sent,e.abrupt("return",!(!n||"success"!==n.resultsCode)&&n);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function w(e){return y.apply(this,arguments)}function y(){return(y=Object(u.a)(s.a.mark((function e(t){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(b.c)("/folder/switchFolderParent",t);case 2:return n=e.sent,e.abrupt("return",!(!n||"success"!==n.resultsCode));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function k(e){return L.apply(this,arguments)}function L(){return(L=Object(u.a)(s.a.mark((function e(t){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(b.c)("/folder/deleteFolder",t);case 2:return n=e.sent,e.abrupt("return",!(!n||"success"!==n.resultsCode)&&n);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var F=n(12),N=n(750),C=n(495),M=n(2),I={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M484 443.1V528h-84.5c-4.1 0-7.5 3.1-7.5 7v42c0 3.8 3.4 7 7.5 7H484v84.9c0 3.9 3.2 7.1 7 7.1h42c3.9 0 7-3.2 7-7.1V584h84.5c4.1 0 7.5-3.2 7.5-7v-42c0-3.9-3.4-7-7.5-7H540v-84.9c0-3.9-3.1-7.1-7-7.1h-42c-3.8 0-7 3.2-7 7.1zm396-144.7H521L403.7 186.2a8.15 8.15 0 00-5.5-2.2H144c-17.7 0-32 14.3-32 32v592c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V330.4c0-17.7-14.3-32-32-32zM840 768H184V256h188.5l119.6 114.4H840V768z"}}]},name:"folder-add",theme:"outlined"},E=n(186),H=function(e,t){return a.createElement(E.a,Object(M.a)(Object(M.a)({},e),{},{ref:t,icon:I}))};H.displayName="FolderAddOutlined";var S=a.forwardRef(H),V={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M928 444H820V330.4c0-17.7-14.3-32-32-32H473L355.7 186.2a8.15 8.15 0 00-5.5-2.2H96c-17.7 0-32 14.3-32 32v592c0 17.7 14.3 32 32 32h698c13 0 24.8-7.9 29.7-20l134-332c1.5-3.8 2.3-7.9 2.3-12 0-17.7-14.3-32-32-32zm-180 0H238c-13 0-24.8 7.9-29.7 20L136 643.2V256h188.5l119.6 114.4H748V444z"}}]},name:"folder-open",theme:"filled"},z=function(e,t){return a.createElement(E.a,Object(M.a)(Object(M.a)({},e),{},{ref:t,icon:V}))};z.displayName="FolderOpenFilled";var D=a.forwardRef(z),T={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M880 298.4H521L403.7 186.2a8.15 8.15 0 00-5.5-2.2H144c-17.7 0-32 14.3-32 32v592c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V330.4c0-17.7-14.3-32-32-32z"}}]},name:"folder",theme:"filled"},B=function(e,t){return a.createElement(E.a,Object(M.a)(Object(M.a)({},e),{},{ref:t,icon:T}))};B.displayName="FolderFilled";var R=a.forwardRef(B),A=n(188),P=n(200),Y=n(198),U=n(642),W=n.n(U),J=n(777),K=n(744),X=n(496),q=n(644),G=n(213),Q=n(299),Z=n(43),$=n(205),ee=n(94),te=n(199),ne=n(222),ae=n(643),re=n.n(ae),ce=n(448),oe=function(e,t){return a.createElement(E.a,Object(M.a)(Object(M.a)({},e),{},{ref:t,icon:ce.a}))};oe.displayName="FolderOpenOutlined";var ie=a.forwardRef(oe),se=n(449),ue=function(e,t){return a.createElement(E.a,Object(M.a)(Object(M.a)({},e),{},{ref:t,icon:se.a}))};ue.displayName="FolderOutlined";var le=a.forwardRef(ue),de=n(328),fe=n(513),pe=n(10),be=J.a.confirm,je=Object(F.g)((function(e){var t=e.folderList,n=e.Width,r=e.history,c=e.getFolderList,o=e.parentId,i=e.folderMap,d=e.getAllFolderList,f=e.showModal,p=Object(a.useState)(),b=Object(l.a)(p,2),j=b[0],h=b[1],m=function(){var e=Object(u.a)(s.a.mark((function e(t,n){var a,r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(a=prompt("\u8bf7\u8f93\u5165\u65b0\u589e\u7684\u6587\u4ef6\u5939\u7684\u540d\u79f0",t))||""===a){e.next=7;break}return r={name:a,folder_id:n},e.next=5,g(r);case 5:e.sent?(N.a.success("\u65b0\u589e\u6587\u4ef6\u5939\u6210\u529f"),c(o)):N.a.error("\u65b0\u589e\u6587\u4ef6\u5939\u5931\u8d25");case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),O=function(e){r.push("/admin/cloud/".concat(e))},v=function(){var e=Object(u.a)(s.a.mark((function e(t,n){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("undefined"===typeof i[n].children){e.next=3;break}return N.a.warning("\u8be5\u6587\u4ef6\u5939\u5185\u8fd8\u6709\u6587\u4ef6\u5939\uff0c\u6682\u4e0d\u652f\u6301\u9012\u5f52\u5220\u9664\uff08\u5176\u5b9e\u91cc\u9762\u6709\u6587\u4ef6\u7684\u8bdd\u4e5f\u4e0d\u63a8\u8350\u5220\u9664\uff09"),e.abrupt("return");case 3:be({title:'\u4f60\u5c06\u5220\u9664"'.concat(t,'"'),content:"Are you sure\uff1f",centered:!0,okText:"Yes",okType:"danger",cancelText:"No",onOk:function(){var e=Object(u.a)(s.a.mark((function e(){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={folder_id:n},e.next=3,k(t);case 3:e.sent?(N.a.success("\u5220\u9664\u6587\u4ef6\u5939\u6210\u529f"),c(o)):N.a.error("\u5220\u9664\u6587\u4ef6\u5939\u5931\u8d25"),d();case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),onCancel:function(){N.a.info("\u5df2\u53d6\u6d88\u5220\u9664\u6587\u4ef6\u5939",1)}});case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();return Object(pe.jsx)(pe.Fragment,{children:t.map((function(e){return Object(pe.jsxs)("div",{className:re.a.folderBox,style:{width:"".concat(n),height:"".concat(n)},onClick:O.bind(null,e.folder_id),onMouseEnter:function(){h(e)},onMouseLeave:function(){h(void 0)},children:[j&&j.folder_id===e.folder_id?Object(pe.jsx)(ie,{className:re.a.folderIcon}):Object(pe.jsx)(le,{className:re.a.folderIcon}),Object(pe.jsx)("div",{children:e.name}),j&&j.folder_id===e.folder_id&&Object(pe.jsxs)("div",{children:[Object(pe.jsx)(de.a,{className:re.a.icon,title:"\u7f16\u8f91\u6587\u4ef6\u5939\u540d\u79f0",onClick:function(t){m(e.name,e.folder_id),t.stopPropagation()}}),Object(pe.jsx)(fe.a,{className:re.a.icon,title:"\u5220\u9664\u6587\u4ef6\u5939",onClick:function(t){v(e.name,e.folder_id),t.stopPropagation()}}),Object(pe.jsx)(X.a,{className:re.a.icon,title:"\u5207\u6362\u6587\u4ef6\u5939",onClick:function(t){f(e,"folder"),t.stopPropagation()}})]})]},e.folder_id)}))})})),he="160px",me=Object(F.g)((function(e){var t=e.parentId,n=e.folderTree,r=e.folderMap,c=e.folderList,o=e.getFolderList,i=e.getAllFolderList,d=Object(a.useState)(!0),f=Object(l.a)(d,2),b=f[0],j=f[1],h=Object(a.useContext)(p.a).username;Object(a.useEffect)((function(){o(t),console.log("parentId",t),t&&(L(t),F(t))}),[t]);var m=Object(a.useState)([]),O=Object(l.a)(m,2),v=O[0],x=O[1],g=Object(a.useState)([]),_=Object(l.a)(g,2),y=_[0],k=_[1],L=function(){var e=Object(u.a)(s.a.mark((function e(t){var n,a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return x([]),j(!0),e.next=4,Object(G.c)(t,h);case 4:(n=e.sent)&&(a=Object(Y.a)(n),""===t&&(a=a.filter((function(e){return"cloud"===e.type}))),x(a)),j(!1);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),F=function(){var e=Object(u.a)(s.a.mark((function e(t){var n,a,r,c,o,i;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return k([]),j(!0),e.next=4,Object(Q.b)(t,h);case 4:if(n=e.sent){a=[],r=Object(Y.a)(n),""===t&&(r=r.filter((function(e){return"cloud"===e.type}))),c=Object(P.a)(r);try{for(c.s();!(o=c.n()).done;)i=o.value,a.push(Object(A.a)(Object(A.a)({},i),{},{fileUrl:"".concat(Z.d,"/file/cloud/").concat(i.filename)}))}catch(s){c.e(s)}finally{c.f()}k(a)}j(!1);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),C=function(e,t){console.log(e),"folder"===t&&T({name:e.name,id:e.folder_id,parent_id:e.parent_id}),"image"===t&&T({name:e.imgname,id:e.img_id,parent_id:e.parent_id}),"file"===t&&T({name:e.originalname,id:e.file_id,parent_id:e.parent_id}),ae(t),S(!0),ie(e.parent_id)},M=function(){var e=Object(u.a)(s.a.mark((function e(){var n,a,c,u;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(oe){e.next=3;break}return N.a.warning("\u8bf7\u9009\u62e9\u4e00\u4e2a\u8282\u70b9",.5),e.abrupt("return");case 3:if(oe!==D.parent_id){e.next=6;break}return N.a.warning("\u4e0e\u539f\u6587\u4ef6\u5939\u76f8\u540c\uff0c\u65e0\u9700\u5207\u6362",.5),e.abrupt("return");case 6:return n=new Promise((function(){})),a={},"file"===U&&(n=Q.c,a={file_id:D.id,other_id:oe}),"image"===U&&(n=G.e,a={img_id:D.id,other_id:oe}),"folder"===U&&(n=w,a={folder_id:D.id,parent_id:oe}),e.next=13,n(a);case 13:c=e.sent,u={folder:"\u6587\u4ef6\u5939",image:"\u56fe\u7247",file:"\u6587\u4ef6"},c?(N.a.success("\u66f4\u6362".concat(u[U||""]," \u201c").concat(D.name,"\u201d \u5230 \u201c").concat(r[oe]?r[oe].name:"\u6839\u76ee\u5f55","\u201d \u6587\u4ef6\u5939\u4e0b\u6210\u529f")),S(!1),T(void 0),ae(void 0),ie(void 0),"image"===U&&L(t),"file"===U&&F(t),"folder"===U&&(o(t),i())):N.a.error("\u66f4\u6362".concat(u[U||""]," \u201c").concat(D.name,"\u201d \u5230 \u201c").concat(r[oe]?r[oe].name:"\u6839\u76ee\u5f55","\u201d \u6587\u4ef6\u5939\u4e0b\u5931\u8d25"));case 16:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),I=Object(a.useState)(!1),E=Object(l.a)(I,2),H=E[0],S=E[1],V=Object(a.useState)(),z=Object(l.a)(V,2),D=z[0],T=z[1],B=Object(a.useState)(),R=Object(l.a)(B,2),U=R[0],ae=R[1],re=Object(a.useState)(),ce=Object(l.a)(re,2),oe=ce[0],ie=ce[1];return Object(pe.jsxs)(pe.Fragment,{children:[Object(pe.jsxs)("div",{className:W.a.imgLength,children:[!b&&Object(pe.jsxs)(pe.Fragment,{children:["\u5171 ",v.length," \u5f20\u56fe\u7247"]}),Object(pe.jsx)("br",{}),!b&&Object(pe.jsxs)(pe.Fragment,{children:["\u5171 ",y.length," \u4e2a\u6587\u4ef6"]})]}),Object(pe.jsxs)("div",{className:W.a.cloudStorage,children:[b&&Object(pe.jsx)(ee.a,{}),Object(pe.jsx)(je,{folderList:c,Width:he,getFolderList:o,parentId:t,folderMap:r,getAllFolderList:i,showModal:C}),"root"!==t&&Object(pe.jsx)(te.a,{type:"cloud",width:he,refresh:function(){L(t),F(t)},other_id:t}),Object(pe.jsx)($.a,{type:"cloud",imageList:v,width:he,refresh:L.bind(null,t),iconRender:function(e){return Object(pe.jsx)(X.a,{title:"\u5207\u6362\u6587\u4ef6\u5939",onClick:C.bind(null,e,"image")})}}),Object(pe.jsx)(ne.a,{fileList:y,width:he,refresh:F.bind(null,t),type:"cloud",iconRender:function(e){return Object(pe.jsx)(X.a,{title:"\u5207\u6362\u6587\u4ef6\u5939",onClick:C.bind(null,e,"file")})}})]}),Object(pe.jsx)(J.a,{title:"\u8bf7\u9009\u62e9\u8981\u5c06 \u201c".concat(D?D.name:"","\u201d \u66f4\u6362\u5230\u7684\u76ee\u5f55"),open:H,onOk:M,onCancel:function(){N.a.warning("\u5df2\u53d6\u6d88\u66f4\u6362\u6587\u4ef6\u5939",.5),S(!1),T(void 0),ae(void 0),ie(void 0)},children:Object(pe.jsx)(K.a,{showIcon:!0,defaultExpandAll:!0,onSelect:function(e,t){e[0]===D.parent_id?N.a.warning("\u4e0e\u6e90\u6587\u4ef6\u5939\u4e00\u81f4",.5):(ie(e[0]),console.log(e[0]))},switcherIcon:Object(pe.jsx)(q.a,{}),treeData:n,selectedKeys:[oe||""]})})]})})),Oe=Object(F.g)((function(e){var t=e.match,n=e.history,r=Object(a.useContext)(p.a).username,c=Object(a.useState)(),o=Object(l.a)(c,2),i=o[0],d=o[1],b=Object(a.useState)({}),h=Object(l.a)(b,2),O=h[0],x=h[1],g=Object(a.useState)([]),_=Object(l.a)(g,2),w=_[0],y=_[1],k=Object(a.useState)("root"),L=Object(l.a)(k,2),F=L[0],M=L[1];Object(a.useEffect)((function(){I()}),[]),Object(a.useEffect)((function(){var e=t.params.parent_id||"root";M(e)}),[t]);var I=function(){var e=Object(u.a)(s.a.mark((function e(){var t,n,a,c;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m(r);case 2:(t=e.sent)&&(n=t.tree,a={},c=function e(t){return t.forEach((function(t){t.title=t.name,t.icon=function(e){return e.selected?Object(pe.jsx)(D,{}):Object(pe.jsx)(R,{})},t.key=t.folder_id,t.children&&(t.children=e(t.children)),a[t.folder_id]=t})),t}(n),d([{title:"\u6839\u76ee\u5f55",key:"root",icon:function(e){return e.selected?Object(pe.jsx)(D,{}):Object(pe.jsx)(R,{})},children:c}]),x(a));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),E=function(){var e=Object(u.a)(s.a.mark((function e(){var t,n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=prompt("\u8bf7\u8f93\u5165\u65b0\u589e\u7684\u6587\u4ef6\u5939\u7684\u540d\u79f0","new folder"))||""===t){e.next=7;break}return n={name:t,parent_id:F},e.next=5,v(n);case 5:e.sent?(N.a.success("\u65b0\u589e\u6587\u4ef6\u5939\u6210\u529f"),H(F),I()):N.a.error("\u65b0\u589e\u6587\u4ef6\u5939\u5931\u8d25");case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),H=function(){var e=Object(u.a)(s.a.mark((function e(t){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return y([]),e.next=3,j(t,r);case 3:(n=e.sent)&&y(n.sort((function(e,t){return new Date(t.cTime).getTime()-new Date(e.cTime).getTime()})));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(pe.jsxs)(pe.Fragment,{children:["root"!==F&&Object(pe.jsxs)("div",{className:f.a.goback,onClick:function(){n.push("/admin/cloud/".concat(O[F].parent_id))},children:[Object(pe.jsx)(C.a,{}),"\u8fd4\u56de\u4e0a\u4e00\u5c42"]}),Object(pe.jsxs)("div",{className:f.a.addFolder,onClick:E,children:[Object(pe.jsx)(S,{}),"\u65b0\u589e\u6587\u4ef6\u5939"]}),Object(pe.jsx)(me,{parentId:F,folderList:w,folderMap:O,folderTree:i,getFolderList:H,getAllFolderList:I})]})}));t.default=function(){return Object(o.a)("cloud"),Object(pe.jsx)("div",{className:c.a.cloud,children:Object(pe.jsx)("div",{className:c.a.cloudContent,children:Object(pe.jsx)(Oe,{})})})}}}]);